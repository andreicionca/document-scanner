<!doctype html>
<html lang="ro">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <title>DocScanner</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.jsdelivr.net/npm/eruda"></script>
    <script>
      eruda.init();
    </script>
  </head>
  <body>
    <div id="app">
      <!-- ECRAN 1: Camera -->
      <div id="screen-camera" class="screen active">
        <div id="camera-container">
          <video id="video" autoplay playsinline muted></video>
        </div>

        <div id="camera-controls">
          <button id="btn-gallery" class="icon-btn">
            ğŸ–¼ï¸
            <span id="gallery-badge" class="badge hidden">0</span>
          </button>

          <button id="btn-capture" class="capture-btn">
            <span class="capture-inner"></span>
          </button>

          <button id="btn-switch" class="icon-btn">ğŸ”„</button>
        </div>
      </div>

      <!-- ECRAN 2: Selectare ColÈ›uri -->
      <div id="screen-crop" class="screen">
        <div class="screen-header">
          <button id="btn-crop-back" class="header-btn">âœ•</button>
          <span>SelecteazÄƒ colÈ›urile</span>
          <button id="btn-crop-done" class="header-btn primary">âœ“</button>
        </div>

        <div id="crop-container">
          <canvas id="crop-canvas"></canvas>

          <!-- ColÈ›uri draggable -->
          <div class="corner-handle" data-corner="0" id="handle-tl"></div>
          <div class="corner-handle" data-corner="1" id="handle-tr"></div>
          <div class="corner-handle" data-corner="2" id="handle-br"></div>
          <div class="corner-handle" data-corner="3" id="handle-bl"></div>

          <!-- SVG pentru linii -->
          <svg id="crop-overlay">
            <polygon id="crop-polygon"></polygon>
          </svg>
        </div>

        <div class="screen-footer">
          <p>Trage colÈ›urile pentru a selecta documentul</p>
        </div>
      </div>

      <!-- ECRAN 3: Previzualizare & Export -->
      <div id="screen-preview" class="screen">
        <div class="screen-header">
          <button id="btn-preview-back" class="header-btn">â†</button>
          <span>Previzualizare</span>
          <button id="btn-save" class="header-btn primary">ğŸ’¾</button>
        </div>

        <div id="preview-container">
          <canvas id="preview-canvas"></canvas>
        </div>

        <div id="preview-options">
          <button class="option-btn active" data-filter="original">Original</button>
          <button class="option-btn" data-filter="enhance">ÃmbunÄƒtÄƒÈ›it</button>
          <button class="option-btn" data-filter="bw">Alb-Negru</button>
          <button class="option-btn" data-filter="grayscale">Gri</button>
        </div>
      </div>

      <!-- ECRAN 4: Galerie -->
      <div id="screen-gallery" class="screen">
        <div class="screen-header">
          <button id="btn-gallery-back" class="header-btn">âœ•</button>
          <span>ScanÄƒri (<span id="scan-count">0</span>)</span>
          <button id="btn-download-all" class="header-btn">ğŸ“¥</button>
        </div>

        <div id="gallery-grid"></div>

        <button id="btn-clear-all" class="danger-btn">È˜terge Tot</button>
      </div>

      <!-- Loading -->
      <div id="loading" class="hidden">
        <div class="spinner"></div>
        <span id="loading-text">Se Ã®ncarcÄƒ...</span>
      </div>

      <!-- Toast -->
      <div id="toast-container"></div>
    </div>

    <script src="https://docs.opencv.org/4.9.0/opencv.js" onload="onOpenCvReady()"></script>
    <script src="app.js"></script>
  </body>
</html>
